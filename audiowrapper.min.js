(function(){var d=function(){this.events={}};d.prototype.on=function(a,b){this.events[a]||(this.events[a]=[]);this.events[a].push(b)};d.prototype.trigger=function(a,b){this.events[a]&&this.events[a].forEach(function(a){a.apply(null,b)})};var c=function(a){var b=new d;this.mediaMode=!1;this.player=null;if("undefined"!==typeof Media){this.mediaMode=!0;this.waitingStop=this.waitingPlay=this.waitingPause=!1;this.waitingStart=!0;var c=0,g=function(){c||(c=setInterval(function(){this.player.getCurrentPosition(function(a){b.trigger("timeupdate",
[a,this.player.getDuration()])}.bind(this))}.bind(this),250))}.bind(this),e=function(){c&&(clearInterval(c),c=0)}.bind(this);this.player=new Media(a,function(){e();b.trigger("stop",[]);this.player.getCurrentPosition(function(a){a.toFixed(2)===this.player.getDuration().toFixed(2)&&b.trigger("ended",[])}.bind(this))}.bind(this),function(){},function(a){Media.MEDIA_RUNNING===a&&this.waitingStart&&(this.waitingStart=!1,this.player.pause(),b.trigger("ready",[this.player.getDuration()]));Media.MEDIA_RUNNING===
a&&this.waitingPlay&&(this.waitingPlay=!1,g(),this.player.getCurrentPosition(function(a){b.trigger("play",[a,this.player.getDuration()])}.bind(this)));Media.MEDIA_PAUSED===a&&this.waitingPause&&(this.waitingPause=!1,e(),this.player.getCurrentPosition(function(a){b.trigger("pause",[a,this.player.getDuration()])}.bind(this)));Media.MEDIA_STOPPED===a&&this.waitingStop&&(this.waitingStop=!1,e(),this.player.getCurrentPosition(function(a){b.trigger("stop",[])}.bind(this)))}.bind(this));this.player.play({playAudioWhenScreenIsLocked:!1})}else{this.player=
$("<audio controls></audio>");if("object"===typeof a)for(var f in a)$('<source src="'+a[f].src+'" type="'+a[f].type+'">').appendTo(this.player);else $('<source src="'+a+'">').appendTo(this.player);this.player.appendTo("body");this.player.on("durationchange",function(){b.trigger("ready",[this.duration])});this.player.on("play",function(){b.trigger("play",[this.currentTime,this.duration])});this.player.on("pause",function(){b.trigger("pause",[this.currentTime,this.duration])});this.player.on("timeupdate",
function(){b.trigger("timeupdate",[this.currentTime,this.duration]);0===this.currentTime&&this.paused&&b.trigger("stop",[])});this.player.on("ended",function(){b.trigger("stop",[]);b.trigger("ended",[])});this.player.on("stop",function(){b.trigger("stop",[])})}this.on=b.on.bind(b);return this};c.prototype.play=function(a){this.mediaMode?this.waitingStart||this.waitingPause||this.waitingPlay||this.waitingStop||(this.waitingPlay=!0,this.player.play({playAudioWhenScreenIsLocked:a})):this.player[0].play()};
c.prototype.pause=function(){this.mediaMode?this.waitingStart||this.waitingPause||this.waitingPlay||this.waitingStop||(this.waitingPause=!0,this.player.pause()):this.player[0].pause()};c.prototype.remove=function(){this.mediaMode?this.player.release():this.player.remove()};c.prototype.seek=function(a){this.mediaMode?this.player.seekTo(parseInt(1E3*a)):this.player[0].currentTime=a};c.prototype.stop=function(){this.mediaMode?this.waitingStart||this.waitingPause||this.waitingPlay||this.waitingStop||
(this.waitingStop=!0,this.player.stop()):(this.player[0].pause(),this.player[0].currentTime=0)};c.prototype.volume=function(a){this.mediaMode?this.player.setVolume(a.toFixed(1)):this.player[0].volume=a};window.AudioWrapper=c})();
